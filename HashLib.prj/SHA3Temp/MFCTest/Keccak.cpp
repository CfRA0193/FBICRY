
#include "stdafx.h"
#include "Keccak.h"

namespace Keccak
{
    void Keccak::TransformBlock(byte* a_data, int a_index)
    {
        ulong Aba, Abe, Abi, Abo, Abu;
        ulong Aga, Age, Agi, Ago, Agu;
        ulong Aka, Ake, Aki, Ako, Aku;
        ulong Ama, Ame, Ami, Amo, Amu;
        ulong Asa, Ase, Asi, Aso, Asu;
        ulong Bba, Bbe, Bbi, Bbo, Bbu;
        ulong Bga, Bge, Bgi, Bgo, Bgu;
        ulong Bka, Bke, Bki, Bko, Bku;
        ulong Bma, Bme, Bmi, Bmo, Bmu;
        ulong Bsa, Bse, Bsi, Bso, Bsu;
        ulong Ca, Ce, Ci, Co, Cu;
        ulong Da, De, Di, Do, Du;
        ulong Eba, Ebe, Ebi, Ebo, Ebu;
        ulong Ega, Ege, Egi, Ego, Egu;
        ulong Eka, Eke, Eki, Eko, Eku;
        ulong Ema, Eme, Emi, Emo, Emu;
        ulong Esa, Ese, Esi, Eso, Esu;

        ulong *state = (ulong*)m_state;

        ulong* data = (ulong*)&a_data[a_index];

        for (int j=0; j<BlockSize / 8; j++)
            state[j] ^= data[j];

        Aba = state[0];
        Abe = state[1];
        Abi = state[2];
        Abo = state[3];
        Abu = state[4];
        Aga = state[5];
        Age = state[6];
        Agi = state[7];
        Ago = state[8];
        Agu = state[9];
        Aka = state[10];
        Ake = state[11];
        Aki = state[12];
        Ako = state[13];
        Aku = state[14];
        Ama = state[15];
        Ame = state[16];
        Ami = state[17];
        Amo = state[18];
        Amu = state[19];
        Asa = state[20];
        Ase = state[21];
        Asi = state[22];
        Aso = state[23];
        Asu = state[24];

        Ca = Aba ^ Aga ^ Aka ^ Ama ^ Asa;
        Ce = Abe ^ Age ^ Ake ^ Ame ^ Ase;
        Ci = Abi ^ Agi ^ Aki ^ Ami ^ Asi;
        Co = Abo ^ Ago ^ Ako ^ Amo ^ Aso;
        Cu = Abu ^ Agu ^ Aku ^ Amu ^ Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x0000000000000001;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x0000000000008082;
        Ca = Aba;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Ce = Abe;
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Ci = Abi;
        Abo = Bbo ^ (Bbu | Bba);
        Co = Abo;
        Abu = Bbu ^ (Bba & Bbe);
        Cu = Abu;
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Ca ^= Aga;
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Ce ^= Age;
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Agi;
        Ago = Bgo ^ (Bgu | Bga);
        Co ^= Ago;
        Agu = Bgu ^ (Bga & Bge);
        Cu ^= Agu;
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Ca ^= Aka;
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Ce ^= Ake;
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ci ^= Aki;
        Ako = ~Bko ^ (Bku | Bka);
        Co ^= Ako;
        Aku = Bku ^ (Bka & Bke);
        Cu ^= Aku;
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Ca ^= Ama;
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Ce ^= Ame;
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Ci ^= Ami;
        Amo = ~Bmo ^ (Bmu & Bma);
        Co ^= Amo;
        Amu = Bmu ^ (Bma | Bme);
        Cu ^= Amu;
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ca ^= Asa;
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ce ^= Ase;
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Ci ^= Asi;
        Aso = Bso ^ (Bsu | Bsa);
        Co ^= Aso;
        Asu = Bsu ^ (Bsa & Bse);
        Cu ^= Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x800000000000808a;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x8000000080008000;
        Ca = Aba;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Ce = Abe;
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Ci = Abi;
        Abo = Bbo ^ (Bbu | Bba);
        Co = Abo;
        Abu = Bbu ^ (Bba & Bbe);
        Cu = Abu;
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Ca ^= Aga;
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Ce ^= Age;
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Agi;
        Ago = Bgo ^ (Bgu | Bga);
        Co ^= Ago;
        Agu = Bgu ^ (Bga & Bge);
        Cu ^= Agu;
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Ca ^= Aka;
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Ce ^= Ake;
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ci ^= Aki;
        Ako = ~Bko ^ (Bku | Bka);
        Co ^= Ako;
        Aku = Bku ^ (Bka & Bke);
        Cu ^= Aku;
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Ca ^= Ama;
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Ce ^= Ame;
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Ci ^= Ami;
        Amo = ~Bmo ^ (Bmu & Bma);
        Co ^= Amo;
        Amu = Bmu ^ (Bma | Bme);
        Cu ^= Amu;
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ca ^= Asa;
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ce ^= Ase;
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Ci ^= Asi;
        Aso = Bso ^ (Bsu | Bsa);
        Co ^= Aso;
        Asu = Bsu ^ (Bsa & Bse);
        Cu ^= Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x000000000000808b;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x0000000080000001;
        Ca = Aba;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Ce = Abe;
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Ci = Abi;
        Abo = Bbo ^ (Bbu | Bba);
        Co = Abo;
        Abu = Bbu ^ (Bba & Bbe);
        Cu = Abu;
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Ca ^= Aga;
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Ce ^= Age;
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Agi;
        Ago = Bgo ^ (Bgu | Bga);
        Co ^= Ago;
        Agu = Bgu ^ (Bga & Bge);
        Cu ^= Agu;
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Ca ^= Aka;
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Ce ^= Ake;
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ci ^= Aki;
        Ako = ~Bko ^ (Bku | Bka);
        Co ^= Ako;
        Aku = Bku ^ (Bka & Bke);
        Cu ^= Aku;
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Ca ^= Ama;
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Ce ^= Ame;
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Ci ^= Ami;
        Amo = ~Bmo ^ (Bmu & Bma);
        Co ^= Amo;
        Amu = Bmu ^ (Bma | Bme);
        Cu ^= Amu;
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ca ^= Asa;
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ce ^= Ase;
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Ci ^= Asi;
        Aso = Bso ^ (Bsu | Bsa);
        Co ^= Aso;
        Asu = Bsu ^ (Bsa & Bse);
        Cu ^= Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x8000000080008081;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x8000000000008009;
        Ca = Aba;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Ce = Abe;
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Ci = Abi;
        Abo = Bbo ^ (Bbu | Bba);
        Co = Abo;
        Abu = Bbu ^ (Bba & Bbe);
        Cu = Abu;
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Ca ^= Aga;
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Ce ^= Age;
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Agi;
        Ago = Bgo ^ (Bgu | Bga);
        Co ^= Ago;
        Agu = Bgu ^ (Bga & Bge);
        Cu ^= Agu;
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Ca ^= Aka;
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Ce ^= Ake;
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ci ^= Aki;
        Ako = ~Bko ^ (Bku | Bka);
        Co ^= Ako;
        Aku = Bku ^ (Bka & Bke);
        Cu ^= Aku;
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Ca ^= Ama;
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Ce ^= Ame;
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Ci ^= Ami;
        Amo = ~Bmo ^ (Bmu & Bma);
        Co ^= Amo;
        Amu = Bmu ^ (Bma | Bme);
        Cu ^= Amu;
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ca ^= Asa;
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ce ^= Ase;
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Ci ^= Asi;
        Aso = Bso ^ (Bsu | Bsa);
        Co ^= Aso;
        Asu = Bsu ^ (Bsa & Bse);
        Cu ^= Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x000000000000008a;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x0000000000000088;
        Ca = Aba;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Ce = Abe;
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Ci = Abi;
        Abo = Bbo ^ (Bbu | Bba);
        Co = Abo;
        Abu = Bbu ^ (Bba & Bbe);
        Cu = Abu;
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Ca ^= Aga;
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Ce ^= Age;
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Agi;
        Ago = Bgo ^ (Bgu | Bga);
        Co ^= Ago;
        Agu = Bgu ^ (Bga & Bge);
        Cu ^= Agu;
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Ca ^= Aka;
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Ce ^= Ake;
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ci ^= Aki;
        Ako = ~Bko ^ (Bku | Bka);
        Co ^= Ako;
        Aku = Bku ^ (Bka & Bke);
        Cu ^= Aku;
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Ca ^= Ama;
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Ce ^= Ame;
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Ci ^= Ami;
        Amo = ~Bmo ^ (Bmu & Bma);
        Co ^= Amo;
        Amu = Bmu ^ (Bma | Bme);
        Cu ^= Amu;
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ca ^= Asa;
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ce ^= Ase;
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Ci ^= Asi;
        Aso = Bso ^ (Bsu | Bsa);
        Co ^= Aso;
        Asu = Bsu ^ (Bsa & Bse);
        Cu ^= Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x0000000080008009;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x000000008000000a;
        Ca = Aba;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Ce = Abe;
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Ci = Abi;
        Abo = Bbo ^ (Bbu | Bba);
        Co = Abo;
        Abu = Bbu ^ (Bba & Bbe);
        Cu = Abu;
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Ca ^= Aga;
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Ce ^= Age;
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Agi;
        Ago = Bgo ^ (Bgu | Bga);
        Co ^= Ago;
        Agu = Bgu ^ (Bga & Bge);
        Cu ^= Agu;
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Ca ^= Aka;
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Ce ^= Ake;
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ci ^= Aki;
        Ako = ~Bko ^ (Bku | Bka);
        Co ^= Ako;
        Aku = Bku ^ (Bka & Bke);
        Cu ^= Aku;
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Ca ^= Ama;
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Ce ^= Ame;
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Ci ^= Ami;
        Amo = ~Bmo ^ (Bmu & Bma);
        Co ^= Amo;
        Amu = Bmu ^ (Bma | Bme);
        Cu ^= Amu;
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ca ^= Asa;
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ce ^= Ase;
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Ci ^= Asi;
        Aso = Bso ^ (Bsu | Bsa);
        Co ^= Aso;
        Asu = Bsu ^ (Bsa & Bse);
        Cu ^= Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x000000008000808b;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x800000000000008b;
        Ca = Aba;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Ce = Abe;
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Ci = Abi;
        Abo = Bbo ^ (Bbu | Bba);
        Co = Abo;
        Abu = Bbu ^ (Bba & Bbe);
        Cu = Abu;
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Ca ^= Aga;
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Ce ^= Age;
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Agi;
        Ago = Bgo ^ (Bgu | Bga);
        Co ^= Ago;
        Agu = Bgu ^ (Bga & Bge);
        Cu ^= Agu;
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Ca ^= Aka;
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Ce ^= Ake;
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ci ^= Aki;
        Ako = ~Bko ^ (Bku | Bka);
        Co ^= Ako;
        Aku = Bku ^ (Bka & Bke);
        Cu ^= Aku;
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Ca ^= Ama;
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Ce ^= Ame;
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Ci ^= Ami;
        Amo = ~Bmo ^ (Bmu & Bma);
        Co ^= Amo;
        Amu = Bmu ^ (Bma | Bme);
        Cu ^= Amu;
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ca ^= Asa;
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ce ^= Ase;
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Ci ^= Asi;
        Aso = Bso ^ (Bsu | Bsa);
        Co ^= Aso;
        Asu = Bsu ^ (Bsa & Bse);
        Cu ^= Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x8000000000008089;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x8000000000008003;
        Ca = Aba;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Ce = Abe;
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Ci = Abi;
        Abo = Bbo ^ (Bbu | Bba);
        Co = Abo;
        Abu = Bbu ^ (Bba & Bbe);
        Cu = Abu;
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Ca ^= Aga;
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Ce ^= Age;
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Agi;
        Ago = Bgo ^ (Bgu | Bga);
        Co ^= Ago;
        Agu = Bgu ^ (Bga & Bge);
        Cu ^= Agu;
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Ca ^= Aka;
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Ce ^= Ake;
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ci ^= Aki;
        Ako = ~Bko ^ (Bku | Bka);
        Co ^= Ako;
        Aku = Bku ^ (Bka & Bke);
        Cu ^= Aku;
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Ca ^= Ama;
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Ce ^= Ame;
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Ci ^= Ami;
        Amo = ~Bmo ^ (Bmu & Bma);
        Co ^= Amo;
        Amu = Bmu ^ (Bma | Bme);
        Cu ^= Amu;
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ca ^= Asa;
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ce ^= Ase;
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Ci ^= Asi;
        Aso = Bso ^ (Bsu | Bsa);
        Co ^= Aso;
        Asu = Bsu ^ (Bsa & Bse);
        Cu ^= Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x8000000000008002;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x8000000000000080;
        Ca = Aba;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Ce = Abe;
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Ci = Abi;
        Abo = Bbo ^ (Bbu | Bba);
        Co = Abo;
        Abu = Bbu ^ (Bba & Bbe);
        Cu = Abu;
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Ca ^= Aga;
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Ce ^= Age;
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Agi;
        Ago = Bgo ^ (Bgu | Bga);
        Co ^= Ago;
        Agu = Bgu ^ (Bga & Bge);
        Cu ^= Agu;
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Ca ^= Aka;
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Ce ^= Ake;
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ci ^= Aki;
        Ako = ~Bko ^ (Bku | Bka);
        Co ^= Ako;
        Aku = Bku ^ (Bka & Bke);
        Cu ^= Aku;
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Ca ^= Ama;
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Ce ^= Ame;
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Ci ^= Ami;
        Amo = ~Bmo ^ (Bmu & Bma);
        Co ^= Amo;
        Amu = Bmu ^ (Bma | Bme);
        Cu ^= Amu;
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ca ^= Asa;
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ce ^= Ase;
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Ci ^= Asi;
        Aso = Bso ^ (Bsu | Bsa);
        Co ^= Aso;
        Asu = Bsu ^ (Bsa & Bse);
        Cu ^= Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x000000000000800a;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x800000008000000a;
        Ca = Aba;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Ce = Abe;
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Ci = Abi;
        Abo = Bbo ^ (Bbu | Bba);
        Co = Abo;
        Abu = Bbu ^ (Bba & Bbe);
        Cu = Abu;
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Ca ^= Aga;
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Ce ^= Age;
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Agi;
        Ago = Bgo ^ (Bgu | Bga);
        Co ^= Ago;
        Agu = Bgu ^ (Bga & Bge);
        Cu ^= Agu;
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Ca ^= Aka;
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Ce ^= Ake;
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ci ^= Aki;
        Ako = ~Bko ^ (Bku | Bka);
        Co ^= Ako;
        Aku = Bku ^ (Bka & Bke);
        Cu ^= Aku;
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Ca ^= Ama;
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Ce ^= Ame;
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Ci ^= Ami;
        Amo = ~Bmo ^ (Bmu & Bma);
        Co ^= Amo;
        Amu = Bmu ^ (Bma | Bme);
        Cu ^= Amu;
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ca ^= Asa;
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ce ^= Ase;
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Ci ^= Asi;
        Aso = Bso ^ (Bsu | Bsa);
        Co ^= Aso;
        Asu = Bsu ^ (Bsa & Bse);
        Cu ^= Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x8000000080008081;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x8000000000008080;
        Ca = Aba;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Ce = Abe;
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Ci = Abi;
        Abo = Bbo ^ (Bbu | Bba);
        Co = Abo;
        Abu = Bbu ^ (Bba & Bbe);
        Cu = Abu;
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Ca ^= Aga;
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Ce ^= Age;
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Agi;
        Ago = Bgo ^ (Bgu | Bga);
        Co ^= Ago;
        Agu = Bgu ^ (Bga & Bge);
        Cu ^= Agu;
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Ca ^= Aka;
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Ce ^= Ake;
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ci ^= Aki;
        Ako = ~Bko ^ (Bku | Bka);
        Co ^= Ako;
        Aku = Bku ^ (Bka & Bke);
        Cu ^= Aku;
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Ca ^= Ama;
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Ce ^= Ame;
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Ci ^= Ami;
        Amo = ~Bmo ^ (Bmu & Bma);
        Co ^= Amo;
        Amu = Bmu ^ (Bma | Bme);
        Cu ^= Amu;
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ca ^= Asa;
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ce ^= Ase;
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Ci ^= Asi;
        Aso = Bso ^ (Bsu | Bsa);
        Co ^= Aso;
        Asu = Bsu ^ (Bsa & Bse);
        Cu ^= Asu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Aba ^= Da;
        Bba = Aba;
        Age ^= De;
        Bbe = (Age << 44) | (Age >> (64 - 44));
        Aki ^= Di;
        Bbi = (Aki << 43) | (Aki >> (64 - 43));
        Eba = Bba ^ (Bbe | Bbi);
        Eba ^= 0x0000000080000001;
        Ca = Eba;
        Amo ^= Do;
        Bbo = (Amo << 21) | (Amo >> (64 - 21));
        Ebe = Bbe ^ (~Bbi | Bbo);
        Ce = Ebe;
        Asu ^= Du;
        Bbu = (Asu << 14) | (Asu >> (64 - 14));
        Ebi = Bbi ^ (Bbo & Bbu);
        Ci = Ebi;
        Ebo = Bbo ^ (Bbu | Bba);
        Co = Ebo;
        Ebu = Bbu ^ (Bba & Bbe);
        Cu = Ebu;
        Abo ^= Do;
        Bga = (Abo << 28) | (Abo >> (64 - 28));
        Agu ^= Du;
        Bge = (Agu << 20) | (Agu >> (64 - 20));
        Aka ^= Da;
        Bgi = (Aka << 3) | (Aka >> (64 - 3));
        Ega = Bga ^ (Bge | Bgi);
        Ca ^= Ega;
        Ame ^= De;
        Bgo = (Ame << 45) | (Ame >> (64 - 45));
        Ege = Bge ^ (Bgi & Bgo);
        Ce ^= Ege;
        Asi ^= Di;
        Bgu = (Asi << 61) | (Asi >> (64 - 61));
        Egi = Bgi ^ (Bgo | ~Bgu);
        Ci ^= Egi;
        Ego = Bgo ^ (Bgu | Bga);
        Co ^= Ego;
        Egu = Bgu ^ (Bga & Bge);
        Cu ^= Egu;
        Abe ^= De;
        Bka = (Abe << 1) | (Abe >> (64 - 1));
        Agi ^= Di;
        Bke = (Agi << 6) | (Agi >> (64 - 6));
        Ako ^= Do;
        Bki = (Ako << 25) | (Ako >> (64 - 25));
        Eka = Bka ^ (Bke | Bki);
        Ca ^= Eka;
        Amu ^= Du;
        Bko = (Amu << 8) | (Amu >> (64 - 8));
        Eke = Bke ^ (Bki & Bko);
        Ce ^= Eke;
        Asa ^= Da;
        Bku = (Asa << 18) | (Asa >> (64 - 18));
        Eki = Bki ^ (~Bko & Bku);
        Ci ^= Eki;
        Eko = ~Bko ^ (Bku | Bka);
        Co ^= Eko;
        Eku = Bku ^ (Bka & Bke);
        Cu ^= Eku;
        Abu ^= Du;
        Bma = (Abu << 27) | (Abu >> (64 - 27));
        Aga ^= Da;
        Bme = (Aga << 36) | (Aga >> (64 - 36));
        Ake ^= De;
        Bmi = (Ake << 10) | (Ake >> (64 - 10));
        Ema = Bma ^ (Bme & Bmi);
        Ca ^= Ema;
        Ami ^= Di;
        Bmo = (Ami << 15) | (Ami >> (64 - 15));
        Eme = Bme ^ (Bmi | Bmo);
        Ce ^= Eme;
        Aso ^= Do;
        Bmu = (Aso << 56) | (Aso >> (64 - 56));
        Emi = Bmi ^ (~Bmo | Bmu);
        Ci ^= Emi;
        Emo = ~Bmo ^ (Bmu & Bma);
        Co ^= Emo;
        Emu = Bmu ^ (Bma | Bme);
        Cu ^= Emu;
        Abi ^= Di;
        Bsa = (Abi << 62) | (Abi >> (64 - 62));
        Ago ^= Do;
        Bse = (Ago << 55) | (Ago >> (64 - 55));
        Aku ^= Du;
        Bsi = (Aku << 39) | (Aku >> (64 - 39));
        Esa = Bsa ^ (~Bse & Bsi);
        Ca ^= Esa;
        Ama ^= Da;
        Bso = (Ama << 41) | (Ama >> (64 - 41));
        Ese = ~Bse ^ (Bsi | Bso);
        Ce ^= Ese;
        Ase ^= De;
        Bsu = (Ase << 2) | (Ase >> (64 - 2));
        Esi = Bsi ^ (Bso & Bsu);
        Ci ^= Esi;
        Eso = Bso ^ (Bsu | Bsa);
        Co ^= Eso;
        Esu = Bsu ^ (Bsa & Bse);
        Cu ^= Esu;

        Da = Cu ^ ((Ce << 1) | (Ce >> (64 - 1)));
        De = Ca ^ ((Ci << 1) | (Ci >> (64 - 1)));
        Di = Ce ^ ((Co << 1) | (Co >> (64 - 1)));
        Do = Ci ^ ((Cu << 1) | (Cu >> (64 - 1)));
        Du = Co ^ ((Ca << 1) | (Ca >> (64 - 1)));
        Eba ^= Da;
        Bba = Eba;
        Ege ^= De;
        Bbe = (Ege << 44) | (Ege >> (64 - 44));
        Eki ^= Di;
        Bbi = (Eki << 43) | (Eki >> (64 - 43));
        Aba = Bba ^ (Bbe | Bbi);
        Aba ^= 0x8000000080008008;
        Emo ^= Do;
        Bbo = (Emo << 21) | (Emo >> (64 - 21));
        Abe = Bbe ^ (~Bbi | Bbo);
        Esu ^= Du;
        Bbu = (Esu << 14) | (Esu >> (64 - 14));
        Abi = Bbi ^ (Bbo & Bbu);
        Abo = Bbo ^ (Bbu | Bba);
        Abu = Bbu ^ (Bba & Bbe);
        Ebo ^= Do;
        Bga = (Ebo << 28) | (Ebo >> (64 - 28));
        Egu ^= Du;
        Bge = (Egu << 20) | (Egu >> (64 - 20));
        Eka ^= Da;
        Bgi = (Eka << 3) | (Eka >> (64 - 3));
        Aga = Bga ^ (Bge | Bgi);
        Eme ^= De;
        Bgo = (Eme << 45) | (Eme >> (64 - 45));
        Age = Bge ^ (Bgi & Bgo);
        Esi ^= Di;
        Bgu = (Esi << 61) | (Esi >> (64 - 61));
        Agi = Bgi ^ (Bgo | ~Bgu);
        Ago = Bgo ^ (Bgu | Bga);
        Agu = Bgu ^ (Bga & Bge);
        Ebe ^= De;
        Bka = (Ebe << 1) | (Ebe >> (64 - 1));
        Egi ^= Di;
        Bke = (Egi << 6) | (Egi >> (64 - 6));
        Eko ^= Do;
        Bki = (Eko << 25) | (Eko >> (64 - 25));
        Aka = Bka ^ (Bke | Bki);
        Emu ^= Du;
        Bko = (Emu << 8) | (Emu >> (64 - 8));
        Ake = Bke ^ (Bki & Bko);
        Esa ^= Da;
        Bku = (Esa << 18) | (Esa >> (64 - 18));
        Aki = Bki ^ (~Bko & Bku);
        Ako = ~Bko ^ (Bku | Bka);
        Aku = Bku ^ (Bka & Bke);
        Ebu ^= Du;
        Bma = (Ebu << 27) | (Ebu >> (64 - 27));
        Ega ^= Da;
        Bme = (Ega << 36) | (Ega >> (64 - 36));
        Eke ^= De;
        Bmi = (Eke << 10) | (Eke >> (64 - 10));
        Ama = Bma ^ (Bme & Bmi);
        Emi ^= Di;
        Bmo = (Emi << 15) | (Emi >> (64 - 15));
        Ame = Bme ^ (Bmi | Bmo);
        Eso ^= Do;
        Bmu = (Eso << 56) | (Eso >> (64 - 56));
        Ami = Bmi ^ (~Bmo | Bmu);
        Amo = ~Bmo ^ (Bmu & Bma);
        Amu = Bmu ^ (Bma | Bme);
        Ebi ^= Di;
        Bsa = (Ebi << 62) | (Ebi >> (64 - 62));
        Ego ^= Do;
        Bse = (Ego << 55) | (Ego >> (64 - 55));
        Eku ^= Du;
        Bsi = (Eku << 39) | (Eku >> (64 - 39));
        Asa = Bsa ^ (~Bse & Bsi);
        Ema ^= Da;
        Bso = (Ema << 41) | (Ema >> (64 - 41));
        Ase = ~Bse ^ (Bsi | Bso);
        Ese ^= De;
        Bsu = (Ese << 2) | (Ese >> (64 - 2));
        Asi = Bsi ^ (Bso & Bsu);
        Aso = Bso ^ (Bsu | Bsa);
        Asu = Bsu ^ (Bsa & Bse);

        state[0] = Aba;
        state[1] = Abe;
        state[2] = Abi;
        state[3] = Abo;
        state[4] = Abu;
        state[5] = Aga;
        state[6] = Age;
        state[7] = Agi;
        state[8] = Ago;
        state[9] = Agu;
        state[10] = Aka;
        state[11] = Ake;
        state[12] = Aki;
        state[13] = Ako;
        state[14] = Aku;
        state[15] = Ama;
        state[16] = Ame;
        state[17] = Ami;
        state[18] = Amo;
        state[19] = Amu;
        state[20] = Asa;
        state[21] = Ase;
        state[22] = Asi;
        state[23] = Aso;
        state[24] = Asu;
    }

    byte* Keccak::ComputeBytes(byte* data, int a_length)
    {
        Initialize();
        TransformBytes(data, 0, a_length);
        return TransformFinal();
    }

    Keccak::Keccak(int a_hashSize)
    {
        BlockSize = 200 - (a_hashSize * 2);
        HashSize = a_hashSize;

        Initialize();
    }

    byte* Keccak::TransformFinal()
    {
        Finish();
        byte* result = GetResult();
        Initialize();
        return result;
    }

    void Keccak::Finish()
    {
        byte* pad = new byte[BlockSize + 3];

        pad[0] = 0x01;
        pad[1] = HashSize;
        pad[2] = BlockSize;
        pad[3] = 0x01;

        memset(&pad[4], 0, BlockSize - 1);

        int index = BlockSize - m_buffer_pos;
        if (index < 4)
            index += BlockSize;
        TransformBytes(pad, 0, index);

        delete pad;

        int negs[] = { 1, 2, 8, 12 }; // static const
        for (int i=0; i<4; i++)
            for (int j=0; j<8; j++)
                m_state[negs[i]*8+j] = ~m_state[negs[i]*8+j];
    }

    byte* Keccak::GetResult()
    {
        byte* result = new byte[HashSize];
        memcpy(result, m_state, HashSize);
        return result;
    }

    void Keccak::Initialize()
    {
        memset(m_state, 0, 200);

        // TODO: tablica stanu poczatkowego m_state
        int negs[] = { 1, 2, 8, 12, 17, 20 }; // TODO: static const
        for (int i=0; i<6; i++)
            for (int j=0; j<8; j++)
                m_state[negs[i]*8+j] = 0xFF;

        memset(m_buffer, 0, 144);
        m_buffer_pos = 0;
    }

    void Keccak::TransformBytes(byte* a_data, int a_index, int a_length)
    {
        if (m_buffer_pos > 0) 
        {
            int left = BlockSize - m_buffer_pos;
            if (left > a_length)
                left = a_length;

            memcpy(&m_buffer[m_buffer_pos], &a_data[a_index], left);
            m_buffer_pos += left;
            a_index += left;
            a_length -= left;

            if (m_buffer_pos == BlockSize)
            {
                TransformBlock(m_buffer, 0);
                m_buffer_pos = 0;
            } 
        }

        while (a_length >= BlockSize)
        {
            TransformBlock(a_data, a_index);

            a_index += BlockSize;
            a_length -= BlockSize;
        }

        if (a_length > 0)
        {
            memcpy(&m_buffer[m_buffer_pos], &a_data[a_index], a_length);
            m_buffer_pos += a_length;
        }
    }
}